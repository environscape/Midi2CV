# MIDI2CV 修改记录 (HOHO备注)

## 版本信息
- **当前版本**: v4.1-custom
- **修改日期**: 2024年2月7日
- **基础固件**: Midi2CV_v4.1.ino

## 修改内容摘要

### 1. 时钟同步增强 (MIDI Clock)
- **新增 6 连音选项**:
  - CC 映射: **CC 24**。
  - 数值范围: 80-99 设为 1/24 音符 (6 连音)。
  - 逻辑: 24 PPQN ÷ 4 = 6 次脉冲/拍。

### 2. Reset 输出功能 (同步外部设备)
- **输出模式切换**:
  - CC 映射: **CC 29**。
  - 数值 0-63: GATE2 输出通道 2 的音符 Gate (默认)。
  - 数值 64-127: **GATE2 切换为 Reset 脉冲输出模式**。
- **Reset 周期设置**:
  - CC 映射: **CC 26**。
  - 0-31: 每 1 小节重置一次。
  - 32-63: 每 2 小节重置一次。
  - 64-95: 每 4 小节重置一次。
  - 96-127: 每 8 小节重置一次。
- **技术细节**:
  - Reset 脉冲宽度固定为 6 个 MIDI Clock ticks (约 1/16 音符宽度)。
  - 支持 MIDI Start 指令强制重置计数器 `total_clock`。

### 3. 代码与硬件规范
- **硬件兼容性**: 完美兼容现有硬件，通过软件分时复用 `GATE2_PIN` (D7) 实现，无需改线。
- **注释保护**: 严格保留了原始代码中的中文及日文备注信息。
- **逻辑保护**: 启用 Reset 模式时，自动屏蔽通道 2 的 MIDI 音符对 GATE2 的干扰。

---
*备注：修改由 GitHub Copilot (Gemini 3 Flash) 协作完成。*
